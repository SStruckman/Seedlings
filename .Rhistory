MORT_DATE int(4) DEFAULT NULL,
DOG_DATE int(4) DEFAULT NULL,
SC int(1) DEFAULT '',
SNAG_HEIGHT double(4,2) DEFAULT NULL,
SNAG_TD double(3,1) DEFAULT NULL,
RELATIVE_PLOT_X double(5,2) DEFAULT NULL,
RELATIVE_PLOT_Y double(5,2) DEFAULT NULL,
SEEDLING_BASAL_DIAM double(4,2) DEFAULT NULL,
SEEDLING_HEIGHT double(3,2) DEFAULT NULL,
LEANER_ANGLE int(3) DEFAULT NULL,
BT varchar(2) NOT NULL,
DT varchar(2) NOT NULL,
RT varchar(2) NOT NULL,
SCAR varchar(2) NOT NULL,
FRASS varchar(2) NOT NULL,
PITCH varchar(2) NOT NULL,
EE varchar(2) NOT NULL,
MT varchar(2) NOT NULL,
CONK varchar(16) NOT NULL,
NEC varchar(2) NOT NULL,
FLAG varchar(2) NOT NULL,
SWELL varchar(2) NOT NULL,
SPRT varchar(9) NOT NULL,
BFB varchar(2) DEFAULT NULL,
OTHER_CODES varchar(20) NOT NULL,
OTHER_HOM double(3,2) DEFAULT NULL,
DIRECTION char(4) DEFAULT NULL,
NW char(1) DEFAULT NULL,
FIELD_X double(5,2) DEFAULT NULL,
FIELD_Y double(5,2) DEFAULT NULL,
REFERENCE varchar(7) DEFAULT NULL,
DISTANCE double(4,2) DEFAULT NULL,
AZIMUTH double(4,1) DEFAULT NULL,
PLOT_X double(5,2) DEFAULT NULL,
PLOT_Y double(5,2) DEFAULT NULL,
UTM_X double(8,2) DEFAULT NULL,
UTM_Y double(9,2) DEFAULT NULL,
UTM_Z double(6,2) DEFAULT NULL,
REMAPPING varchar(80) NOT NULL,
PREVIOUS_TAGS varchar(24) DEFAULT NULL,
COMMENT varchar(255) DEFAULT NULL,
PLOT varchar(4) DEFAULT NULL,
FIELD_1 varchar(20) NOT NULL,
FIELD_2 varchar(20) DEFAULT NULL,
FIELD_3 varchar(20) DEFAULT NULL,
FIELD_4 varchar(20) DEFAULT NULL,
FIELD_5 varchar(20) DEFAULT NULL,
DATA_ENTRY_1 varchar(20) DEFAULT NULL,
DATA_ENTRY_2 varchar(20) DEFAULT NULL,
DATA_CHECK varchar(20) DEFAULT NULL,
CTFS_DA char(1),
UPDATED char(8) DEFAULT NULL,
DNA char(8) DEFAULT NULL,
CORED int(4) DEFAULT NULL,
COOKIE int(4) DEFAULT NULL,
EST_ESTABLISHMENT int(9) DEFAULT NULL,
DATABASE_HISTORY varchar(240) NOT NULL,
PRIMARY KEY (STEM_TAG,CENSUS)
CONSTRAINT Tree_ibfk_14 FOREIGN KEY (QUADRAT) REFERENCES Grid (QUADRAT)
);")
seedling.db = dbConnect(RSQLite::SQLite(), "./Data_raw/seedlings.db")
dbExecute(seedling.db,
"CREATE TABLE Seedling (
STEM_TAG char(7) NOT NULL DEFAULT '',
TREE_TAG char(7) NOT NULL,
CENSUS int(2) NOT NULL,
DATE char(8) NOT NULL,
QUADRAT char(3) NOT NULL,
SPECIES varchar(8) NOT NULL,
DBH double(4,1) DEFAULT NULL,
DBH_YEAR int(4) NOT NULL,
STATUS int(2) DEFAULT '0',
VIGOR int(1) DEFAULT '',
DA varchar(3) DEFAULT NULL,
MORT_DATE int(4) DEFAULT NULL,
DOG_DATE int(4) DEFAULT NULL,
SC int(1) DEFAULT '',
SNAG_HEIGHT double(4,2) DEFAULT NULL,
SNAG_TD double(3,1) DEFAULT NULL,
RELATIVE_PLOT_X double(5,2) DEFAULT NULL,
RELATIVE_PLOT_Y double(5,2) DEFAULT NULL,
SEEDLING_BASAL_DIAM double(4,2) DEFAULT NULL,
SEEDLING_HEIGHT double(3,2) DEFAULT NULL,
LEANER_ANGLE int(3) DEFAULT NULL,
BT varchar(2) NOT NULL,
DT varchar(2) NOT NULL,
RT varchar(2) NOT NULL,
SCAR varchar(2) NOT NULL,
FRASS varchar(2) NOT NULL,
PITCH varchar(2) NOT NULL,
EE varchar(2) NOT NULL,
MT varchar(2) NOT NULL,
CONK varchar(16) NOT NULL,
NEC varchar(2) NOT NULL,
FLAG varchar(2) NOT NULL,
SWELL varchar(2) NOT NULL,
SPRT varchar(9) NOT NULL,
BFB varchar(2) DEFAULT NULL,
OTHER_CODES varchar(20) NOT NULL,
OTHER_HOM double(3,2) DEFAULT NULL,
DIRECTION char(4) DEFAULT NULL,
NW char(1) DEFAULT NULL,
FIELD_X double(5,2) DEFAULT NULL,
FIELD_Y double(5,2) DEFAULT NULL,
REFERENCE varchar(7) DEFAULT NULL,
DISTANCE double(4,2) DEFAULT NULL,
AZIMUTH double(4,1) DEFAULT NULL,
PLOT_X double(5,2) DEFAULT NULL,
PLOT_Y double(5,2) DEFAULT NULL,
UTM_X double(8,2) DEFAULT NULL,
UTM_Y double(9,2) DEFAULT NULL,
UTM_Z double(6,2) DEFAULT NULL,
REMAPPING varchar(80) NOT NULL,
PREVIOUS_TAGS varchar(24) DEFAULT NULL,
COMMENT varchar(255) DEFAULT NULL,
PLOT varchar(4) DEFAULT NULL,
FIELD_1 varchar(20) NOT NULL,
FIELD_2 varchar(20) DEFAULT NULL,
FIELD_3 varchar(20) DEFAULT NULL,
FIELD_4 varchar(20) DEFAULT NULL,
FIELD_5 varchar(20) DEFAULT NULL,
DATA_ENTRY_1 varchar(20) DEFAULT NULL,
DATA_ENTRY_2 varchar(20) DEFAULT NULL,
DATA_CHECK varchar(20) DEFAULT NULL,
CTFS_DA char(1),
UPDATED char(8) DEFAULT NULL,
DNA char(8) DEFAULT NULL,
CORED int(4) DEFAULT NULL,
COOKIE int(4) DEFAULT NULL,
EST_ESTABLISHMENT int(9) DEFAULT NULL,
DATABASE_HISTORY varchar(240) NOT NULL,
PRIMARY KEY (STEM_TAG,CENSUS)
CONSTRAINT Tree_ibfk_14 FOREIGN KEY (QUADRAT) REFERENCES Grid (QUADRAT)
);")
dbExecute(seedling.db,
"CREATE TABLE Soil (
SAMPLE_ID varchar(5) NOT NULL,
QUADRAT char(3) NOT NULL,
TYPE varchar(16) NOT NULL DEFAULT '',
UTM_X double(8,2) DEFAULT NULL,
UTM_Y double(9,2) DEFAULT NULL,
DESCRIPTION varchar(80) NOT NULL,
FIELD_COMMENTS varchar(80) DEFAULT NULL,
SURVEY_YEAR char(4) NOT NULL,
BOTTLE&KCL double(5,2) DEFAULT NULL,
BOTTLE&KCL&SOIL double(5,2) DEFAULT NULL,
EMPTY_PAN double(4,2) DEFAULT NULL,
FRESH_SOIL double(5,2) DEFAULT NULL,
DRY_SOIL&PAN double(5,2) DEFAULT NULL,
DRY_SOIL double(5,2) DEFAULT NULL,
DRY_WT double(5,2) DEFAULT NULL,
DRY_SOIL_IN_KCL double(5,2) DEFAULT NULL,
SOLUTION_VOL double(5,2) DEFAULT NULL,
NH4_mg_N_per_L double(5,2) DEFAULT NULL,
NO3_mg_N_per_L double(5,2) DEFAULT NULL,
pH_water double(3,2) DEFAULT NULL,
pH_CaCl2 double(3,2) DEFAULT NULL,
pH_BaCl2 double(3,2) DEFAULT NULL,
BrayP_mg_per_kg double(7,4) DEFAULT NULL,
NH4_mgN_per_kg double(6,4) DEFAULT NULL,
NO3_mgN_per_kg double(6,4) DEFAULT NULL,
Inorg_N_mgN_per_kg double(6,4) DEFAULT NULL,
Al_mg_per_kg double(7,4) DEFAULT NULL,
Ca_mg_per_kg double(7,2) DEFAULT NULL,
Fe_mg_per_kg double(6,4) DEFAULT NULL,
K_mg_per_kg double(7,2) DEFAULT NULL,
Mg_mg_per_kg double(7,2) DEFAULT NULL,
Mn_mg_per_kg double(7,4) DEFAULT NULL,
Na_mg_per_kg double(7,4) DEFAULT NULL,
Al_cmolc_per_kg double(5,4) DEFAULT NULL,
Ca_cmolc_per_kg double(7,4) DEFAULT NULL,
Fe_cmolc_per_kg double(5,4) DEFAULT NULL,
K_cmolc_per_kg double(5,4) DEFAULT NULL,
Mg_cmolc_per_kg double(6,4) DEFAULT NULL,
Mn_cmolc_per_kg double(5,4) DEFAULT NULL,
Na_cmolc_per_kg double(5,4) DEFAULT NULL,
TEB_cmolc_per_kg double(6,3) DEFAULT NULL,
ECEC_cmolc_per_kg double(6,3) DEFAULT NULL,
Base_sat_percent double(6,3) DEFAULT NULL,
Al_sat_percent double(6,3) DEFAULT NULL,
Ca_to_Mg_ratio double(6,3) DEFAULT NULL,
PRIMARY KEY (SAMPLE_ID)
)"
)
dbExecute(seedling.db,
"CREATE TABLE Soil (
SAMPLE_ID varchar(5) NOT NULL,
QUADRAT char(3) NOT NULL,
TYPE varchar(16) NOT NULL DEFAULT '',
UTM_X double(8,2) DEFAULT NULL,
UTM_Y double(9,2) DEFAULT NULL,
DESCRIPTION varchar(80) NOT NULL,
FIELD_COMMENTS varchar(80) DEFAULT NULL,
SURVEY_YEAR char(4) NOT NULL,
`BOTTLE&KCL` double(5,2) DEFAULT NULL,
`BOTTLE&KCL&SOIL` double(5,2) DEFAULT NULL,
EMPTY_PAN double(4,2) DEFAULT NULL,
FRESH_SOIL double(5,2) DEFAULT NULL,
`DRY_SOIL&PAN` double(5,2) DEFAULT NULL,
DRY_SOIL double(5,2) DEFAULT NULL,
DRY_WT double(5,2) DEFAULT NULL,
DRY_SOIL_IN_KCL double(5,2) DEFAULT NULL,
SOLUTION_VOL double(5,2) DEFAULT NULL,
NH4_mg_N_per_L double(5,2) DEFAULT NULL,
NO3_mg_N_per_L double(5,2) DEFAULT NULL,
pH_water double(3,2) DEFAULT NULL,
pH_CaCl2 double(3,2) DEFAULT NULL,
pH_BaCl2 double(3,2) DEFAULT NULL,
BrayP_mg_per_kg double(7,4) DEFAULT NULL,
NH4_mgN_per_kg double(6,4) DEFAULT NULL,
NO3_mgN_per_kg double(6,4) DEFAULT NULL,
Inorg_N_mgN_per_kg double(6,4) DEFAULT NULL,
Al_mg_per_kg double(7,4) DEFAULT NULL,
Ca_mg_per_kg double(7,2) DEFAULT NULL,
Fe_mg_per_kg double(6,4) DEFAULT NULL,
K_mg_per_kg double(7,2) DEFAULT NULL,
Mg_mg_per_kg double(7,2) DEFAULT NULL,
Mn_mg_per_kg double(7,4) DEFAULT NULL,
Na_mg_per_kg double(7,4) DEFAULT NULL,
Al_cmolc_per_kg double(5,4) DEFAULT NULL,
Ca_cmolc_per_kg double(7,4) DEFAULT NULL,
Fe_cmolc_per_kg double(5,4) DEFAULT NULL,
K_cmolc_per_kg double(5,4) DEFAULT NULL,
Mg_cmolc_per_kg double(6,4) DEFAULT NULL,
Mn_cmolc_per_kg double(5,4) DEFAULT NULL,
Na_cmolc_per_kg double(5,4) DEFAULT NULL,
TEB_cmolc_per_kg double(6,3) DEFAULT NULL,
ECEC_cmolc_per_kg double(6,3) DEFAULT NULL,
Base_sat_percent double(6,3) DEFAULT NULL,
Al_sat_percent double(6,3) DEFAULT NULL,
Ca_to_Mg_ratio double(6,3) DEFAULT NULL,
PRIMARY KEY (SAMPLE_ID)
)"
)
dbExecute(seedling.db,
"CREATE TABLE Mortality (
STEM_TAG char(7) NOT NULL,
QUADRAT char(3) NOT NULL,
SPECIES varchar(8) NOT NULL,
DATE char(8) NOT NULL,
CENSUS int(2) NOT NULL,
DBH decimal(4,1) DEFAULT NULL,
ROOT int(1) DEFAULT NULL,
STEM int(1) DEFAULT NULL,
SNAG_HEIGHT decimal(4,2) DEFAULT NULL,
SNAG_TD double(2,0) DEFAULT NULL,
CROWN_P int(3) DEFAULT NULL,
TREE_P int(3) DEFAULT NULL,
ANGLE int(3) DEFAULT NULL,
GROUND_P int(3) DEFAULT NULL,
SUPPORT_P int(3) DEFAULT NULL,
CC1 varchar(2) DEFAULT NULL,
CC2 varchar(2) DEFAULT NULL,
CC3 varchar(2) DEFAULT NULL,
CC4 varchar(2) DEFAULT NULL,
CC5 varchar(2) DEFAULT NULL,
FAD1 varchar(5) NOT NULL DEFAULT '0',
FAD2 varchar(5) NOT NULL DEFAULT '0',
FAD3 varchar(5) NOT NULL DEFAULT '0',
FAD4 varchar(5) NOT NULL DEFAULT '0',
FAD5 varchar(5) NOT NULL DEFAULT '0',
COMMENT varchar(400) DEFAULT NULL,
DALB_DATE varchar(9) DEFAULT NULL,
FIELD_1 varchar(20) DEFAULT NULL,
FIELD_2 varchar(20) DEFAULT NULL,
FIELD_3 varchar(20) DEFAULT NULL,
FIELD_4 varchar(20) DEFAULT NULL,
FIELD_5 varchar(20) DEFAULT NULL,
DATA_ENTRY_1 varchar(20) DEFAULT NULL,
DATA_ENTRY_2 varchar(20) DEFAULT NULL,
DATA_CHECK_1 varchar(20) DEFAULT NULL,
DATA_CHECK_2 varchar(20) DEFAULT NULL,
UPDATED char(8) NOT NULL,
PRIMARY KEY (STEM_TAG),
CONSTRAINT Mortality_ibfk_1 FOREIGN KEY (STEM_TAG) REFERENCES Seedling (STEM_TAG),
CONSTRAINT Mortality_ibfk_17 FOREIGN KEY (QUADRAT) REFERENCES Grid (QUADRAT),
);"
)
dbExecute(seedling.db,
"CREATE TABLE Mortality (
STEM_TAG char(7) NOT NULL,
QUADRAT char(3) NOT NULL,
SPECIES varchar(8) NOT NULL,
DATE char(8) NOT NULL,
CENSUS int(2) NOT NULL,
DBH decimal(4,1) DEFAULT NULL,
ROOT int(1) DEFAULT NULL,
STEM int(1) DEFAULT NULL,
SNAG_HEIGHT decimal(4,2) DEFAULT NULL,
SNAG_TD double(2,0) DEFAULT NULL,
CROWN_P int(3) DEFAULT NULL,
TREE_P int(3) DEFAULT NULL,
ANGLE int(3) DEFAULT NULL,
GROUND_P int(3) DEFAULT NULL,
SUPPORT_P int(3) DEFAULT NULL,
CC1 varchar(2) DEFAULT NULL,
CC2 varchar(2) DEFAULT NULL,
CC3 varchar(2) DEFAULT NULL,
CC4 varchar(2) DEFAULT NULL,
CC5 varchar(2) DEFAULT NULL,
FAD1 varchar(5) NOT NULL DEFAULT '0',
FAD2 varchar(5) NOT NULL DEFAULT '0',
FAD3 varchar(5) NOT NULL DEFAULT '0',
FAD4 varchar(5) NOT NULL DEFAULT '0',
FAD5 varchar(5) NOT NULL DEFAULT '0',
COMMENT varchar(400) DEFAULT NULL,
DALB_DATE varchar(9) DEFAULT NULL,
FIELD_1 varchar(20) DEFAULT NULL,
FIELD_2 varchar(20) DEFAULT NULL,
FIELD_3 varchar(20) DEFAULT NULL,
FIELD_4 varchar(20) DEFAULT NULL,
FIELD_5 varchar(20) DEFAULT NULL,
DATA_ENTRY_1 varchar(20) DEFAULT NULL,
DATA_ENTRY_2 varchar(20) DEFAULT NULL,
DATA_CHECK_1 varchar(20) DEFAULT NULL,
DATA_CHECK_2 varchar(20) DEFAULT NULL,
UPDATED char(8) NOT NULL,
PRIMARY KEY (STEM_TAG),
CONSTRAINT Mortality_ibfk_1 FOREIGN KEY (STEM_TAG) REFERENCES Seedling (STEM_TAG),
CONSTRAINT Mortality_ibfk_17 FOREIGN KEY (QUADRAT) REFERENCES Grid (QUADRAT)
);"
)
library(tidyverse)
library(DBI)
library(RSQLite)
## Load tabular data
seed.raw = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Seedling')])),na.strings='NULL')
mort.raw = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Mort_')])),na.strings='NULL')
soil = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Soil')])),na.strings='NULL') %>%
dplyr::select(-SAMPLE_NUM) %>%
filter(!SAMPLE_ID %in% c('P1','P2','P3','P4','P5','P6'))
grid.poly = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Grid_Poly')])),na.strings='NULL')
seedling.db = dbConnect(RSQLite::SQLite(), "./Data_raw/seedlings.db")
dbWriteTable(seedling.db, "Grid", grid.poly, append = TRUE)
seedling.db = dbConnect(RSQLite::SQLite(), "./Data_raw/seedlings.db")
dbWriteTable(seedling.db, "Grid", grid.poly, append = TRUE)
dbWriteTable(seedling.db, "Seedling", seed.raw, append = TRUE)
dbWriteTable(seedling.db, "Grid", grid.poly, append = TRUE)
dbWriteTable(seedling.db, "Seedling", seed.raw, append = TRUE)
dbWriteTable(seedling.db, "Mort", mort.raw, append = TRUE)
dbWriteTable(seedling.db, "Soil", soil, append = TRUE)
View(soil)
names(soil)[BOTTLE.KCL.SOIL]
names(soil)['BOTTLE.KCL.SOIL']
names(soil)
test = rename(soil, BOTTLE&KCL = BOTTLE.KCL)
test = dplyr::rename(soil, BOTTLE&KCL = BOTTLE.KCL)
test = dplyr::rename(soil, BOTTLE.KCL = BOTTLE&KCL)
test = dplyr::rename(soil, BOTTLE.KCL = `BOTTLE&KCL`)
test = dplyr::rename(soil, `BOTTLE&KCL` = BOTTLE.KCL)
View(test)
soil = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Soil')])),na.strings='NULL') %>%
dplyr::select(-SAMPLE_NUM) %>%
filter(!SAMPLE_ID %in% c('P1','P2','P3','P4','P5','P6')) %>%
dplyr::rename(`BOTTLE&KCL` = BOTTLE.KCL,
`BOTTLE&KCL&SOIL` = BOTTLE.KCL.SOIL,
`DRY&SOIL&PAN` = DRY.SOIL.PAN)
soil = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Soil')])),na.strings='NULL') %>%
dplyr::select(-SAMPLE_NUM) %>%
filter(!SAMPLE_ID %in% c('P1','P2','P3','P4','P5','P6')) %>%
dplyr::rename(`BOTTLE&KCL` = BOTTLE.KCL,
`BOTTLE&KCL&SOIL` = BOTTLE.KCL.SOIL,
`DRY_SOIL&PAN` = DRY_SOIL.PAN)
dbWriteTable(seedling.db, "Soil", soil, append = TRUE)
install.packages('tinytex')
tinytex::install_tinytex()
install.packages('tinytex')
tinytex::install_tinytex()
cat('hi')
message('hi')
warning('hi')
error('hi')
error_message('hi')
test = factor(c(10,10,10,7,800))
as.numeric(levels(test))
as.numeric(as.character(test))
test = data.frame(x = 1:3, y = c(10,20,30))
test[x<3,]
test[test$x<3,]
1 %>% %+%2
1 %>% %*%(2)
1 %*%(2)
2 %*%(2)
2 %>% %*%(2)
'test' %>% print()
library(magrittr)
'test' %>% print()
2 %>% %*%(2)
2 %>% `*`(2)
dbWriteTable(seedling.db, "Mortality", mort.raw, append = TRUE)
seedling.db = dbConnect(RSQLite::SQLite(), "./Data_raw/seedlings.db")
dbWriteTable(seedling.db, "Mortality", mort.raw, append = TRUE)
`%notin%` = Negate(`%in%`)
test
test %>% filter(x %notin% c(3))
test %>% dplyr::filter(x %notin% c(3))
?Control
tmp = data.frame(x = 1:5, y = 10:15)
tmp = data.frame(x = 1:5, y = 11:15)
tmp2 = list(tmp, tmp+10, tmp+20)
View(tmp2)
unlist(tmp2)
tmp3 = unlist(tmp2)
tmp3 = as.data.frame(tmp2)
View(tmp3)
tmp4 = rbind(tmp2[[1:3]])
View(tmp4)
tmp4 = rbind(tmp2[[1]])
tmp2[[1:3]]
tmp2[[1,3]]
tmp2[[1]][3]
tmp2[1]
tmp2[1:3]
tmp4 = rbind(tmp2[1:3])
View(tmp4[[1]][[1]])
View(tmp4[[3]][[1]])
library(tidyverse)
`%notin%` = Negate(`%in%`)
## Load tabular data
#Seedling table
seed.raw = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Seedling')])),na.strings=c('NA','NULL'))
#Mortality table
mort.raw = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Mort_')])),na.strings=c('NA','NULL'))
#Soil table
soil = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Soil')])),na.strings=c('NA','NULL')) %>%
dplyr::select(-SAMPLE_NUM) %>%
filter(SAMPLE_ID %notin% c('P1','P2','P3','P4','P5','P6')) %>%
dplyr::rename(`BOTTLE&KCL` = BOTTLE.KCL,
`BOTTLE&KCL&SOIL` = BOTTLE.KCL.SOIL,
`DRY_SOIL&PAN` = DRY_SOIL.PAN)
#Grid table
grid.poly = read.csv(paste0('./Data_raw/',max(dir('./Data_raw')[grepl(dir('./Data_raw/'),pattern = 'Grid_Poly')])),na.strings=c('NA','NULL'))
seed = seed.raw
#extract any columns that are entirely empty and remove them
tmp = c()
for (i in colnames(seed)){
if(sum(!is.na(seed[,i])) == 0){
tmp = c(tmp,i)
}
}
seed = seed %>% dplyr::select(-all_of(tmp))
seed = seed %>% dplyr::select((-c(FLAG, PLOT, CTFS_DA, CORED, DATA_ENTRY_1, DATA_ENTRY_2, DATA_CHECK,
REFERENCE, DISTANCE, AZIMUTH, PLOT_X, PLOT_Y)))
View(seed)
test = filter(seed, is.na(SEEDLINGBASAL_DIAM))
test = filter(seed, is.na(SEEDLING_BASAL_DIAM))
View(test)
test = filter(seed, is.na(SEEDLING_HEIGHT))
View(mort.raw)
sum(!is.na(seed$MORT_DATE))
test = filter(seed, !is.na(MORT_DATE))
View(test)
length(unique(test$STEM_TAG))
View(mort.raw)
View(seed.raw)
sum(!is.na(seed.raw$FIELD_X))
sum(!is.na(seed.raw$RELATIVE_PLOT_X))
View(grid.poly)
View(mort.raw)
View(soil)
View(seed)
test = filter(seed, CENSUS==1, DBH>=1)
View(test)
test1 = filter(seed, DBH>=1)
View(test1)
test2 = filter(test2, STEM_TAG %notin% test1$STEM_TAG)
test2 = filter(test1, STEM_TAG %notin% test$STEM_TAG)
View(test2)
test3 = filter(seed, STEM_TAG %in% test2$STEM_TAG)
View(test3)
tmp = seed %>% group_by(STEM_TAG) %>% mutate(CENSUS_ENTRIES = str_c(CENSUS, collapse='-'))
View(tmp)
test5 = filter(tmp, (CENSUS==1 & DBH>=1))
test5 = filter(tmp, (!str_detect(CENSUS_ENTRIES, pattern='1') & CENSUS!=6 & DBH>=1))
View(test5)
test5 = filter(tmp, (CENSUS_ENTRIES=='6' & DBH>=1))
View(test2)
View(test5)
test6 = filter(tmp, STEM_TAG %in% test2$STEM_TAG)
View(test6)
tmp = seed %>%
group_by(STEM_TAG) %>%
mutate(CENSUS_ENTRIES = str_c(CENSUS, collapse='-')) %>%
filter((CENSUS==1 & DBH>=1) |
(!str_detect(CENSUS_ENTRIES, pattern='1') & CENSUS!=6 & DBH>=1) |
(CENSUS_ENTRIES=='6' & DBH>=1))
View(tmp)
saplings = seed %>% filter(STEM_TAG %in% tmp$STEM_TAG)
test7 = filter(tmp, CENSUS_ENTRIES=='1-6')
test7 = filter(tmp, CENSUS_ENTRIES %in% c('1-6','5-6'))
seed = seed %>% filter(STEM_TAG %notin% tmp$STEM_TAG)
View(saplings)
write.csv(saplings, paste0('./Data_clean/Sapling_clean_',format(Sys.time(), "%Y%m%d"),'.csv'))
write.csv(seed, './Data_clean/Seedling_clean_',format(Sys.time(), "%Y%m%d"),'.csv')
write.csv(saplings, paste0('./Data_clean/Sapling_clean_',format(Sys.time(), "%Y%m%d"),'.csv'))
write.csv(seed, paste0('./Data_clean/Seedling_clean_',format(Sys.time(), "%Y%m%d"),'.csv'))
write.csv(mort, paste0('./Data_clean/Mort_clean_',format(Sys.time(), "%Y%m%d"),'.csv'))
mort = mort.raw %>% filter(STEM_TAG %notin% tmp$STEM_TAG)
write.csv(mort, paste0('./Data_clean/Mort_clean_',format(Sys.time(), "%Y%m%d"),'.csv'))
View(grid.poly)
View(soil)
View(grid.poly)
atan(2/(2*sqrt(2)))
atan(1/(sqrt(2)))
?atan
atan(1/(sqrt(2)))*(180/pi)
atan(1/(sqrt(2)))*(180/pi)*2
(atan(1/(sqrt(2)))*(180/pi)*2+(90))/4
90+35.264
(90+35.264)/4
atan(1/(sqrt(2)))*(180/pi)
(atan(1/(sqrt(2)))*(180/pi)+45)/3
